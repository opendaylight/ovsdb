{
  "comments": [
    {
      "key": {
        "uuid": "9a6a9dd7_a6acf88d",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/SouthboundHandler.java",
        "patchSetId": 5
      },
      "lineNbr": 89,
      "author": {
        "id": 773
      },
      "writtenOn": "2015-06-03T22:35:44Z",
      "side": 1,
      "message": "with the network being created in this path, will interface events with the getRouterExternal still work as expected?",
      "range": {
        "startLine": 89,
        "startChar": 20,
        "endLine": 89,
        "endChar": 45
      },
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_3126e069",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/SouthboundHandler.java",
        "patchSetId": 5
      },
      "lineNbr": 89,
      "author": {
        "id": 1450
      },
      "writtenOn": "2015-06-04T02:52:00Z",
      "side": 1,
      "message": "tbh, I don\u0027t quite know what to expect, yet. My intention was to keep the code unchanged, except for letting external network event percolate to the neutronL3Adapter.\n\nLet me revisit that at another gerrit, once I spend more quality time testing the floating ip handler.",
      "parentUuid": "9a6a9dd7_a6acf88d",
      "range": {
        "startLine": 89,
        "startChar": 20,
        "endLine": 89,
        "endChar": 45
      },
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_46f87ce5",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/SouthboundHandler.java",
        "patchSetId": 5
      },
      "lineNbr": 92,
      "author": {
        "id": 65
      },
      "writtenOn": "2015-06-03T21:34:51Z",
      "side": 1,
      "message": "in the old code we are checking two condition before calling handlerInterfaceEvent(), and with the new change we are dropping a check and also calling it in case if the interface belongs to external network as well? Just want to make sure that\u0027s intentional.",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_512b5430",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/SouthboundHandler.java",
        "patchSetId": 5
      },
      "lineNbr": 92,
      "author": {
        "id": 1450
      },
      "writtenOn": "2015-06-04T02:52:00Z",
      "side": 1,
      "message": "My intention was to keep the code unchanged, except for letting external network event percolate to the neutronL3Adapter.\n\nLet me revisit that at another gerrit, once I spend more quality time testing the floating ip handler.",
      "parentUuid": "9a6a9dd7_46f87ce5",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_2699c86e",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/api/ConfigurationService.java",
        "patchSetId": 5
      },
      "lineNbr": 124,
      "author": {
        "id": 773
      },
      "writtenOn": "2015-06-03T22:35:44Z",
      "side": 1,
      "message": "still have Forwardinfg - the extra f at the end",
      "range": {
        "startLine": 124,
        "startChar": 19,
        "endLine": 124,
        "endChar": 41
      },
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_f1c38888",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/api/ConfigurationService.java",
        "patchSetId": 5
      },
      "lineNbr": 124,
      "author": {
        "id": 1450
      },
      "writtenOn": "2015-06-04T02:52:00Z",
      "side": 1,
      "message": "argh... copy and paste magic. sorry for not remembering to fix that.",
      "parentUuid": "9a6a9dd7_2699c86e",
      "range": {
        "startLine": 124,
        "startChar": 19,
        "endLine": 124,
        "endChar": 41
      },
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_a6e63843",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/impl/BridgeConfigurationManagerImpl.java",
        "patchSetId": 5
      },
      "lineNbr": 125,
      "author": {
        "id": 65
      },
      "writtenOn": "2015-06-03T21:34:51Z",
      "side": 1,
      "message": "we should put these strings in Constants.java",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_86bbf4c3",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/impl/BridgeConfigurationManagerImpl.java",
        "patchSetId": 5
      },
      "lineNbr": 125,
      "author": {
        "id": 773
      },
      "writtenOn": "2015-06-03T22:35:44Z",
      "side": 1,
      "message": "yeah, flavio do you have an updated patch since this was the code I originally added as a reference? \n\nDoes thsi work when the right patch names are used?",
      "parentUuid": "9a6a9dd7_a6e63843",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_b1bd1005",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/impl/BridgeConfigurationManagerImpl.java",
        "patchSetId": 5
      },
      "lineNbr": 125,
      "author": {
        "id": 1450
      },
      "writtenOn": "2015-06-04T02:52:00Z",
      "side": 1,
      "message": "yeah, I messed up here. this code should be using the constants. Let me fix that",
      "parentUuid": "9a6a9dd7_86bbf4c3",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_86d53445",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/impl/BridgeConfigurationManagerImpl.java",
        "patchSetId": 5
      },
      "lineNbr": 177,
      "author": {
        "id": 65
      },
      "writtenOn": "2015-06-03T21:34:51Z",
      "side": 1,
      "message": "can we put warn/error, if this condition should not happen?",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_d1ba040a",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/impl/BridgeConfigurationManagerImpl.java",
        "patchSetId": 5
      },
      "lineNbr": 177,
      "author": {
        "id": 1450
      },
      "writtenOn": "2015-06-04T02:52:00Z",
      "side": 1,
      "message": "sounds good; will do",
      "parentUuid": "9a6a9dd7_86d53445",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_465ddce8",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/impl/BridgeConfigurationManagerImpl.java",
        "patchSetId": 5
      },
      "lineNbr": 378,
      "author": {
        "id": 65
      },
      "writtenOn": "2015-06-03T21:34:51Z",
      "side": 1,
      "message": "this can create bit of race condition. Because you are creating external bridge in the same method, and then you are reading it from operational data store. This can probably return null, in case where you read operational data before external-bridge details are written in the operational data store by southbound plugin. Looking at the logic it looks like you don\u0027t have any trigger condition for creating the patch port as such, so i would suggest that you can batch config data store write for creation of external-bridge + patch port in same transaction and dump into data store. That way you can avoid the data store read for external bridge before patch port creation. You probably can do the same for integration bridge creation as well.",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_e6d0b0f9",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/impl/BridgeConfigurationManagerImpl.java",
        "patchSetId": 5
      },
      "lineNbr": 378,
      "author": {
        "id": 773
      },
      "writtenOn": "2015-06-03T22:35:44Z",
      "side": 1,
      "message": "this should never happen since the brExt is created at the same time as the brint when the ovsdb node first connects. Adding the bridges in here is just a last ditch catchall.\n\nWe could create the patches at that same time. The existing code only created the bridges on node connect and then waits for the interface updates to decide what else to add to teh bridges. This was because vlan and tunnels required different bridges and patches and when we had the openflow 1.0.\n\nI wonder if we should just call the isNetworkReadyxx() in place of createLocalNetwork in SouthboundHandler to just verify the network setup is there. And then in the createOvsdbNode patch add the createLocalNetwork(0 or both network types to ensure vlans and tunnels would be ready.\n\nOr does being able to add the network config during interface updates help or catch any weird corner cases?",
      "parentUuid": "9a6a9dd7_465ddce8",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_b1199024",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/impl/BridgeConfigurationManagerImpl.java",
        "patchSetId": 5
      },
      "lineNbr": 378,
      "author": {
        "id": 1450
      },
      "writtenOn": "2015-06-04T02:52:00Z",
      "side": 1,
      "message": "My original change actually made no attempt to create bridges here; only patch ports. So, prepareNode() would be\nthe only place where bridge creation happened.\n\nIs there ever a chance that prepareNode() may not be called? Assuming not, it is a bit redundant to create bridges here, and we should just remove it.\n\nI like postponing the creation of the patch ports until network is created. Anil: would we still have a race if only patch ports were created here?",
      "parentUuid": "9a6a9dd7_e6d0b0f9",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_ac6137d5",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/impl/BridgeConfigurationManagerImpl.java",
        "patchSetId": 5
      },
      "lineNbr": 378,
      "author": {
        "id": 65
      },
      "writtenOn": "2015-06-04T07:36:24Z",
      "side": 1,
      "message": "Nope, In general these race conditions pops up, when you just wrote something to config data store to configure the ovs, and try to read it immediately from operational data store to carry out the next action, that can cause the issue, because you might or might not find data in operational data. It will pass if southbound successfully write to operational data store before you read, else it will fail. So if you just create patch port and your next action is not dependent on the operational data of patch port, you should be fine.",
      "parentUuid": "9a6a9dd7_b1199024",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_2c5a0784",
        "filename": "openstack/net-virt/src/main/java/org/opendaylight/ovsdb/openstack/netvirt/impl/BridgeConfigurationManagerImpl.java",
        "patchSetId": 5
      },
      "lineNbr": 378,
      "author": {
        "id": 1450
      },
      "writtenOn": "2015-06-04T10:40:26Z",
      "side": 1,
      "message": "Understood. That is good then; I think the creation of the bridge can stay or can be removed w/out affecting the creation of the patch ports.",
      "parentUuid": "9a6a9dd7_ac6137d5",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_c6680c8a",
        "filename": "openstack/net-virt/src/test/java/org/opendaylight/ovsdb/openstack/netvirt/impl/BridgeConfigurationManagerImplTest.java",
        "patchSetId": 5
      },
      "lineNbr": 231,
      "author": {
        "id": 65
      },
      "writtenOn": "2015-06-03T21:34:51Z",
      "side": 1,
      "message": "please remove tab",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a6a9dd7_913c8c95",
        "filename": "openstack/net-virt/src/test/java/org/opendaylight/ovsdb/openstack/netvirt/impl/BridgeConfigurationManagerImplTest.java",
        "patchSetId": 5
      },
      "lineNbr": 231,
      "author": {
        "id": 1450
      },
      "writtenOn": "2015-06-04T02:52:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9a6a9dd7_c6680c8a",
      "revId": "52fb098056704a8c81fca8398d46d69d20f44554",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}